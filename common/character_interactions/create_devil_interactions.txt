ask_for_become_lesser_succubus_interaction = {
	icon = lesser_devil
	desc = ask_for_become_lesser_succubus_interaction.desc
	category = interaction_category_diplomacy
	use_diplomatic_range = {
		scope:actor = { is_ai = yes }
	}
	common_interaction = yes
	cooldown = { years = 10 }

	is_shown = {
		scope:actor = {
			is_female = yes
			NOR = {
				has_trait = sbs_demon
				has_trait = sbs_succubus
				has_trait = sbs_lesser_succubus
			}
		}
		scope:recipient = {
			OR = {
				has_trait = sbs_demon
				is_valid_construction_alchemy3_trigger = yes
			}
		}
	}
	is_valid = {
		scope:actor = {
			has_trait = lustful
			OR = {
				has_trait = deviant
				any_secret = { secret_type = secret_deviant }
			}
			ON = {
				has_trait = witch
				any_secret = { secret_type = secret_witch }
			}
			OR = {
				any_prisoner = { count > 0 }
				any_courtier = { count > 0 }
			}
		}
	}

	populate_recipient_list = {
		scope:actor = {
			every_courtier = { add_to_list = characters }
			every_prisoner = { add_to_list = characters }
		}
	}
	send_option = {
		is_valid = {
			scope:actor = {
				has_usable_hook = scope:recipient
			}
		}
		flag = hook
		localization = GENERIC_SPEND_A_HOOK
	}
	send_option = {
		is_valid = {
			exists = scope:recipient
			scope:recipient = {
				can_add_hook = {
					target = scope:actor
					type = favor_hook
				}
			}
		}
		flag = favor
		localization = "RANSOM_OWE_FAVOR_OPTION"
	}
	send_option = {
		flag = demand_conversion
		localization = "RELEASE_DEMAND_CONVERSION"
		is_shown = {
			NOT = { scope:recipient.faith = scope:actor.faith }
		}
		is_valid = {
			custom_description = {
				text = cannot_demand_religious_head_conversion
				subject = scope:recipient
				NOT = {
					AND = {
						exists = scope:recipient.faith.religious_head
						scope:recipient.faith.religious_head = scope:recipient
					}
				}
			}
		}
	}
	send_options_exclusive = no

	on_accept = {
		scope:actor = {
			remove_character_modifier = succubus_buff
			mind_break_personality = yes
			add_trait = sbs_lesser_succubus
			set_immortal_age = 18
			if = {
				limit = {
					scope:hook = yes
					has_hook = scope:recipient
				}
				use_hook = scope:recipient
			}
			if = {
				limit = {
					scope:demand_conversion = yes
				}
				set_character_faith_with_conversion = scope:recipient.faith
			}
		}
		scope:recipient = {
			if = {
				limit = { scope:favor = yes }
				add_hook = {
					target = scope:actor
					type = fabrication_hook
				}
			}
			add_character_modifier = { modifier = cast_spell_recetly years = 10 }
		}
		scope:secondary_recipient = {
			death = {
				death_reason = death_execution
				killer = scope:actor
			}
		}
	}
	ai_accept = {
		base = 0
		opinion_modifier = {
			opinion_target = scope:actor
			who = scope:recipient
			multiplier = 0.5
		}
		opinion_modifier = {
			opinion_target = scope:secondary_recipient
			who = scope:recipient
			multiplier = -0.2
		}
		modifier = { add = 10 scope:actor = { has_trait = lustful } }
		modifier = { add = 10 scope:actor = { has_trait = deviant } }
		modifier = { add = 10 scope:actor = { has_trait = witch } }
		modifier = { add = 10 scope:actor = { any_secret = { secret_type = secret_deviant is_known_by = scope:recipient } } }
		modifier = { add = 10 scope:actor = { any_secret = { secret_type = secret_witch is_known_by = scope:recipient } } }
		modifier = { add = 50 scope:hook = yes }
		modifier = { add = 25 scope:favor = yes }
		modifier = { add = 25 scope:demand_conversion = yes }
	}

	ai_potential = { always = yes }
	ai_frequency = 12
	ai_targets = {
		ai_recipients = liege
		ai_recipients = vassals
		ai_recipients = peer_vassals
		ai_recipients = courtiers
		ai_recipients = neighboring_rulers
		ai_recipients = nearby_domicile_owners
		max = 5
	}

	ai_will_do = {
		base = 0
		modifier = {
			add = 5
			scope:actor = {
				has_trait = lustful
				OR = {
					has_trait = deviant
					any_secret = { secret_type = secret_deviant }
				}
				OR = {
					has_trait = witch
					any_secret = { secret_type = secret_witch }
				}
			}
		}
		modifier = {
			add = 1
			scope:hook = yes
			scope:actor = {
				has_trait = lustful
				OR = {
					has_trait = deviant
					any_secret = { secret_type = secret_deviant }
				}
				OR = {
					has_trait = witch
					any_secret = { secret_type = secret_witch }
				}
			}
		}
		modifier = {
			add = 1
			scope:favor = yes
			scope:actor = {
				has_trait = lustful
				OR = {
					has_trait = deviant
					any_secret = { secret_type = secret_deviant }
				}
				OR = {
					has_trait = witch
					any_secret = { secret_type = secret_witch }
				}
			}
		}
		modifier = {
			add = 1
			scope:demand_conversion = yes
			NOT = { scope:actor = { has_trait = zealous } }
			scope:actor = {
				has_trait = lustful
				OR = {
					has_trait = deviant
					any_secret = { secret_type = secret_deviant }
				}
				OR = {
					has_trait = witch
					any_secret = { secret_type = secret_witch }
				}
			}
		}
		modifier = { add = -7 scope:secondary_recipient = { is_child_of = scope:actor } }
		modifier = { add = -6 scope:secondary_recipient = { is_spouse_of = scope:actor } }
		modifier = { add = -5 scope:secondary_recipient = { is_close_or_extended_family_of = scope:actor } }
		modifier = { add = -5 scope:secondary_recipient = { has_relation_best_friend = scope:actor } }
		modifier = { add = -4 scope:secondary_recipient = { has_relation_friend = scope:actor } }
		modifier = { add = -5 scope:secondary_recipient = { has_relation_soulmate = scope:actor } }
		modifier = { add = -4 scope:secondary_recipient = { has_relation_lover = scope:actor } }
	}
}

ask_for_become_succubus_interaction = {
	icon = devil
	desc = ask_for_become_succubus_interaction.desc
	category = interaction_category_diplomacy
	use_diplomatic_range = {
		scope:actor = { is_ai = yes }
	}
	common_interaction = yes
	cooldown = { years = 25 }

	is_shown = {
		scope:actor = {
			has_trait = sbs_lesser_succubus
		}
		scope:recipient = {
			has_trait = sbs_demon
		}
	}
	is_valid = {
		scope:actor = {
			has_trait_xp = {
				trait = sbs_lesser_succubus
				value >= 100
			}
			any_prisoner = { count >= 13 }
			any_courtier = {
				OR = {
					is_spouse_of = scope:actor
					is_close_or_extended_family_of = scope:actor
				}
			}
		}
	}

	populate_recipient_list = {
		scope:actor = {
			every_courtier = {
				limit = {
					OR = {
						is_spouse_of = scope:actor
						is_close_or_extended_family_of = scope:actor
					}
				}
				add_to_list = characters
			}
		}
	}
	send_option = {
		is_valid = {
			scope:actor = {
				has_usable_hook = scope:recipient
			}
		}
		flag = hook
		localization = GENERIC_SPEND_A_HOOK
	}
	send_option = {
		is_valid = {
			exists = scope:recipient
			scope:recipient = {
				can_add_hook = {
					target = scope:actor
					type = favor_hook
				}
			}
		}
		flag = favor
		localization = "RANSOM_OWE_FAVOR_OPTION"
	}
	send_option = {
		flag = demand_conversion
		localization = "RELEASE_DEMAND_CONVERSION"
		is_valid = {
			NOT = { scope:recipient.faith = scope:actor.faith }
			custom_description = {
				text = cannot_demand_religious_head_conversion
				subject = scope:recipient
				NOT = {
					AND = {
						exists = scope:recipient.faith.religious_head
						scope:recipient.faith.religious_head = scope:recipient
					}
				}
			}
		}
	}
	send_options_exclusive = no

	on_accept = {
		scope:actor = {
			remove_trait = sbs_lesser_succubus
			add_trait = sbs_succubus
			set_immortal_age = 18
			if = {
				limit = {
					scope:hook = yes
					has_hook = scope:recipient
				}
				use_hook = scope:recipient
			}
			if = {
				limit = {
					scope:demand_conversion = yes
				}
				set_character_faith_with_conversion = scope:recipient.faith
			}
			every_prisoner = {
				death = {
					death_reason = death_execution
					killer = scope:actor
				}
			}
		}
		scope:recipient = {
			if = {
				limit = { scope:favor = yes }
				add_hook = {
					target = scope:actor
					type = fabrication_hook
				}
			}
			add_character_modifier = { modifier = cast_spell_recetly years = 25 }
		}
		scope:secondary_recipient = {
			death = {
				death_reason = death_execution
				killer = scope:actor
			}
		}
	}

	ai_accept = {
		base = 0
		opinion_modifier = {
			opinion_target = scope:actor
			who = scope:recipient
			multiplier = 0.5
		}
		opinion_modifier = {
			opinion_target = scope:secondary_recipient
			who = scope:recipient
			multiplier = -0.2
		}
		modifier = { add = 10 scope:actor = { has_trait = lustful } }
		modifier = { add = 10 scope:actor = { has_trait = deviant } }
		modifier = { add = 10 scope:actor = { has_trait = witch } }
		modifier = { add = 10 scope:actor = { any_secret = { secret_type = secret_deviant is_known_by = scope:recipient } } }
		modifier = { add = 10 scope:actor = { any_secret = { secret_type = secret_witch is_known_by = scope:recipient } } }
		modifier = { add = 25 scope:hook = yes }
		modifier = { add = 25 scope:favor = yes }
		modifier = { add = 25 scope:demand_conversion = yes }
	}
	ai_potential = { always = yes }
	ai_frequency = 12
	ai_targets = {
		ai_recipients = liege
		ai_recipients = vassals
		ai_recipients = peer_vassals
		ai_recipients = courtiers
		ai_recipients = neighboring_rulers
		ai_recipients = nearby_domicile_owners
		max = 5
	}

	ai_will_do = {
		base = 0
		modifier = {
			add = 25
			scope:actor = {
				has_trait_xp = {
					trait = sbs_lesser_succubus
					value >= 100
				}
			}
		}
		modifier = {
			add = 5
			scope:hook = yes
			scope:actor = {
				has_trait_xp = {
					trait = sbs_lesser_succubus
					value >= 100
				}
			}
		}
		modifier = {
			add = 5
			scope:favor = yes
			scope:actor = {
				has_trait_xp = {
					trait = sbs_lesser_succubus
					value >= 100
				}
			}
		}
		modifier = {
			add = 5
			scope:demand_conversion = yes
			NOT = { scope:actor = { has_trait = zealous } }
			scope:actor = {
				has_trait = lustful
				OR = {
					has_trait = deviant
					any_secret = { secret_type = secret_deviant }
				}
				OR = {
					has_trait = witch
					any_secret = { secret_type = secret_witch }
				}
			}
		}
	}
}

succubus_create_lesser_succubus_interaction = {
	icon = lesser_devil
	desc = succubus_create_lesser_succubus_interaction.desc
	category = interaction_category_diplomacy
	use_diplomatic_range = yes
	cooldown = { years = 25 }
	common_interaction = yes
	is_shown = {
		scope:recipient = {
			is_female = yes
			NOR = {
				has_trait = sbs_demon
				has_trait = sbs_succubus
				has_trait = sbs_lesser_succubus
			}
			has_trait = lustful
			OR = {
				has_trait = deviant
				any_secret = { secret_type = secret_deviant }
			}
			OR = {
				has_trait = witch
				any_secret = { secret_type = secret_witch }
			}
		}
		scope:actor = {
			OR = {
				has_trait = sbs_demon
				has_trait = sbs_succubus
			}
		}
	}
	is_valid = {
		scope:actor = {
			OR = {
				has_trait = sbs_demon
				is_valid_construction_alchemy3_trigger = yes
			}
		}
		OR = {
			scope:recipient = {
				is_ruler = yes
				OR = {
					any_prisoner = { count > 0 }
					any_courtier = { count > 0 }
				}
			}
			scope:actor = {
				scope:recipient = { is_ruler = no }
				OR = {
					any_prisoner = { count > 0 NOT = { this = scope:recipient } }
					any_courtier = { count > 0 NOT = { this = scope:recipient } }
				}
			}
		}
	}
	populate_recipient_list = {
		scope:recipient = {
			is_ruler = yes
			every_prisoner = { add_to_list = characters }
			every_courtier = { add_to_list = characters }
		}
		scope:actor = {
			every_prisoner = { limit = { NOT = { this = scope:recipient } scope:recipient = { is_ruler = no } } add_to_list = characters }
			every_courtier = { limit = { NOT = { this = scope:recipient } scope:recipient = { is_ruler = no } } add_to_list = characters }
		}
	}
	on_accept = {
		scope:recipient = {
			remove_character_modifier = succubus_buff
			add_trait = sbs_lesser_succubus
			set_immortal_age = 18
		}
		scope:secondary_recipient = {
			death = {
				death_reason = death_execution
				killer = scope:recipient
			}
		}
	}
	ai_accept = {
		base = 10
		opinion_modifier = {
			opinion_target = scope:actor
			who = scope:recipient
			multiplier = 0.5
		}
		opinion_modifier = {
			opinion_target = scope:secondary_recipient
			who = scope:recipient
			multiplier = -0.2
		}
		modifier = { add = -80 scope:secondary_recipient = { is_child_of = scope:recipient } }
		modifier = { add = -80 scope:secondary_recipient = { is_spouse_of = scope:recipient } }
		modifier = { add = -50 scope:secondary_recipient = { is_close_or_extended_family_of = scope:recipient } }
		modifier = { add = -50 scope:secondary_recipient = { has_relation_best_friend = scope:recipient } }
		modifier = { add = -30 scope:secondary_recipient = { has_relation_friend = scope:recipient } }
		modifier = { add = -80 scope:secondary_recipient = { has_relation_soulmate = scope:recipient } }
		modifier = { add = -50 scope:secondary_recipient = { has_relation_lover = scope:recipient } }
		modifier = { add = 30 scope:secondary_recipient = { has_relation_nemesis = scope:recipient } }
		modifier = { add = 20 scope:secondary_recipient = { has_relation_rival = scope:recipient } }
	}
	ai_frequency = 12
	ai_targets = {
		ai_recipients = family
		ai_recipients = liege
		ai_recipients = vassals
		ai_recipients = prisoners
		ai_recipients = courtiers
		ai_recipients = scripted_relations
		max = 5
	}
	ai_potential = { always = yes }
	ai_will_do = {
		base = 0
		modifier = { add = 25 scope:recipient = { is_child_of = scope:actor } }
		modifier = { add = 5 scope:recipient = { is_female = yes is_courtier_of = scope:actor } }
		modifier = { add = 5 scope:recipient = { is_female = yes is_vassal_of = scope:actor } }
		modifier = { add = -100 scope:secondary_recipient = { is_child_of = scope:recipient } }
		modifier = { add = -100 scope:secondary_recipient = { is_spouse_of = scope:recipient } }
		modifier = { add = -100 scope:secondary_recipient = { is_close_or_extended_family_of = scope:recipient } }
		modifier = { add = -100 scope:secondary_recipient = { has_relation_best_friend = scope:recipient } }
		modifier = { add = -100 scope:secondary_recipient = { has_relation_friend = scope:recipient } }
		modifier = { add = -100 scope:secondary_recipient = { has_relation_soulmate = scope:recipient } }
		modifier = { add = -100 scope:secondary_recipient = { has_relation_lover = scope:recipient } }
		modifier = { add = 100 scope:recipient = { is_ai = no } }
	}
}

succubus_create_succubus_interaction = {
	icon = devil
	desc = succubus_create_succubus_interaction.desc
	category = interaction_category_diplomacy
	use_diplomatic_range = yes
	common_interaction = yes
	cooldown = { years = 50 }
	is_shown = {
		scope:recipient = {
			NOR = {
				has_trait = sbs_demon
				has_trait = sbs_succubus
			}
			has_trait = sbs_lesser_succubus
		}
		scope:actor = {
			has_trait = sbs_demon
		}
	}
	is_valid = {
		scope:recipient = {
			has_trait_xp = {
				trait = sbs_lesser_succubus
				value >= 100
			}
		}
		OR = {
			scope:recipient = {
				is_ruler = yes
				any_prisoner = { count >= 13 }
				any_courtier = {
					OR = {
						is_spouse_of = scope:recipient
						is_close_or_extended_family_of = scope:recipient
					}
				}
			}
			scope:actor = {
				scope:recipient = { is_ruler = no }
				any_prisoner = { count >= 13 NOT = { this = scope:recipient } }
				any_courtier = { OR = { is_spouse_of = scope:recipient is_close_or_extended_family_of = scope:recipient } NOT = { this = scope:recipient } }
			}
		}
	}
	populate_recipient_list = {
		scope:recipient = {
			is_ruler = yes
			every_courtier = {
				limit = {
					OR = {
						is_spouse_of = scope:recipient
						is_close_or_extended_family_of = scope:recipient
					}
				}
				add_to_list = characters
			}
		}
		scope:actor = {
			every_courtier = {
				limit = {
					OR = {
						is_spouse_of = scope:recipient
						is_close_or_extended_family_of = scope:recipient
					}
					NOT = { this = scope:recipient }
					scope:recipient = { is_ruler = no }
				}
				add_to_list = characters
			}
		}
	}
	on_accept = {
		scope:recipient = {
			if = {
				limit = { is_ruler = yes }
				every_prisoner = {
					death = {
						death_reason = death_execution
						killer = scope:recipient
					}
				}
			}
			remove_trait = sbs_lesser_succubus
			add_trait = sbs_succubus
			set_immortal_age = 18
		}
		scope:actor = {
			if = {
				limit = { scope:recipient = { is_ruler = no } }
				every_prisoner = {
					limit = { NOT = { this = scope:recipient } }
					death = {
						death_reason = death_execution
						killer = scope:recipient
					}
				}
			}
		}
		scope:secondary_recipient = {
			death = {
				death_reason = death_execution
				killer = scope:recipient
			}
		}
	}
	ai_accept = {
		base = 10
		opinion_modifier = {
			opinion_target = scope:actor
			who = scope:recipient
			multiplier = 0,5
		}
		opinion_modifier = {
			opinion_target = scope:secondary_recipient
			who = scope:recipient
			multiplier = -0.2
		}
	}
	ai_frequency = 12
	ai_targets = {
		ai_recipients = family
		ai_recipients = liege
		ai_recipients = vassals
		ai_recipients = prisoners
		ai_recipients = courtiers
		ai_recipients = scripted_relations
		max = 5
	}
	ai_potential = { always = yes }
	ai_will_do = {
		base = 0
		modifier = { add = 5 scope:recipient = { is_female = yes is_courtier_of = scope:actor } }
		modifier = { add = 5 scope:recipient = { is_female = yes is_vassal_of = scope:actor } }
		modifier = { add = 25 scope:secondary_recipient = { is_child_of = scope:recipient } }
		modifier = { add = 100 scope:recipient = { is_ai = no } }
	}
}
